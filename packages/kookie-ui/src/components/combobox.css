/* Combobox styles extend BaseMenu primitives and TextField tokens for search input parity. */
@import './_internal/base-menu.css';
@import './text-field.css';

/* Reset Popover.Content padding - base-menu handles padding via BaseMenuViewport */
.rt-ComboboxContent {
  padding: 0 !important;
  max-height: var(--radix-popover-content-available-height);
  display: flex;
  flex-direction: column;
}

/* 
 * Hide content when closed (forceMount keeps items mounted for label registration).
 * Using visibility + position to keep items in DOM for label registration while
 * making them invisible and non-interactive.
 */
.rt-ComboboxContent[data-state='closed'] {
  visibility: hidden;
  position: absolute;
  pointer-events: none;
}

.rt-ComboboxCommand {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

.rt-ComboboxViewport {
  padding-top: 0 !important;
}

.rt-BaseMenuContent:where(.rt-r-size-1) :where(.rt-ComboboxItem) {
  --base-menu-item-padding-left: calc(var(--space-5) / 1.2);
}

.rt-BaseMenuContent:where(.rt-r-size-1) :where(.rt-ComboboxLabel) {
  --base-menu-item-padding-left: calc(var(--space-5) / 1.2);
}

.rt-BaseMenuContent:where(.rt-r-size-2) :where(.rt-ComboboxItem),
.rt-BaseMenuContent:where(.rt-r-size-3) :where(.rt-ComboboxItem) {
  --base-menu-item-padding-left: var(--space-5);
}

.rt-BaseMenuContent:where(.rt-r-size-2) :where(.rt-ComboboxLabel),
.rt-BaseMenuContent:where(.rt-r-size-3) :where(.rt-ComboboxLabel) {
  --base-menu-item-padding-left: var(--space-5);
}

/* 
 * Override disabled styles when data-disabled is false or empty (cmdk may set it incorrectly).
 * This CSS-only approach replaces the per-item MutationObserver workaround for better performance.
 * We reset all visual properties that base-menu applies to [data-disabled] items.
 */
.rt-BaseMenuContent :where(.rt-BaseMenuItem.rt-ComboboxItem[data-disabled='false']),
.rt-BaseMenuContent :where(.rt-BaseMenuItem.rt-ComboboxItem[data-disabled='']) {
  color: inherit !important;
  cursor: var(--cursor-menu-item) !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

/* Sticky search input with consistent padding */
.rt-ComboboxSearch {
  position: sticky;
  top: 0;
  z-index: 1;
  padding: var(--base-menu-content-padding);
  background-color: var(--color-panel);
}

:where([data-panel-background='translucent']) .rt-ComboboxSearch {
  background-color: var(--color-panel-translucent);
  backdrop-filter: var(--backdrop-filter-panel);
}

.rt-ComboboxSearch :where(.rt-ComboboxInputRoot) {
  width: 100%;
}

.rt-ScrollAreaRoot:where(.rt-ComboboxScrollArea) {
  flex: 1;
  min-height: 0;
}

/*
 * Map cmdk's data-selected state to highlighted styling.
 * Mirrors base-menu's [data-highlighted] styling but for cmdk's [data-selected].
 * 
 * IMPORTANT: background-color applies only to the item itself.
 * color is explicitly set on ALL descendants (* selector) because user content
 * (Flex, icons, text) may have intermediate wrappers that break CSS inheritance.
 */

/* Solid variant - highlighted item */
.rt-BaseMenuContent.rt-variant-solid .rt-ComboboxItem[data-selected='true'] {
  background-color: var(--accent-9);
  color: var(--accent-contrast);
}

/* Force color on all descendants (text, icons, wrappers) */
.rt-BaseMenuContent.rt-variant-solid .rt-ComboboxItem[data-selected='true'] * {
  color: var(--accent-contrast) !important;
}

/* Soft variant - highlighted item */
.rt-BaseMenuContent.rt-variant-soft .rt-ComboboxItem[data-selected='true'] {
  background-color: var(--accent-4);
}

:where([data-panel-background='translucent'], [data-material='translucent']) .rt-BaseMenuContent.rt-variant-soft .rt-ComboboxItem[data-selected='true'] {
  background-color: var(--accent-a4);
}

/* High contrast - highlighted item */
.rt-BaseMenuContent.rt-high-contrast .rt-ComboboxItem[data-selected='true'] {
  background-color: var(--accent-12);
  color: var(--accent-1);
}

.rt-BaseMenuContent.rt-high-contrast .rt-ComboboxItem[data-selected='true'] * {
  color: var(--accent-1) !important;
}

/* High contrast with accent color */
.rt-BaseMenuContent.rt-high-contrast[data-accent-color] .rt-ComboboxItem[data-selected='true'] {
  background-color: var(--accent-9);
  color: var(--accent-contrast);
}

.rt-BaseMenuContent.rt-high-contrast[data-accent-color] .rt-ComboboxItem[data-selected='true'] * {
  color: var(--accent-contrast) !important;
}
